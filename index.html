<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Password Vault</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/js-sha1/0.6.0/sha1.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/react@18.2.0/umd/react.development.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/react-dom@18.2.0/umd/react-dom.development.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@babel/standalone@7.20.6/babel.min.js"></script>
    <style>
        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
        }
        .sidebar {
            transition: transform 0.3s ease;
        }
        .sidebar-hidden {
            transform: translateX(-100%);
        }
        .glass {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        .dark .glass {
            background: rgba(0, 0, 0, 0.2);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        .modal {
            transition: opacity 0.3s ease, transform 0.3s ease;
            transform: translateY(-20px);
            opacity: 0;
        }
        .modal.show {
            transform: translateY(0);
            opacity: 1;
        }
        .strength-bar {
            height: 8px;
            border-radius: 4px;
            transition: width 0.4s ease, background-color 0.4s ease;
        }
        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }
        .tooltip {
            position: absolute;
            background: #1f2937;
            color: white;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 12px;
            z-index: 1000;
        }
    </style>
</head>
<body class="min-h-screen bg-gradient-to-br from-indigo-100 to-cyan-100 dark:from-gray-900 dark:to-gray-800 transition-colors duration-300">
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useContext, createContext, useRef } = React;
        const { createRoot } = ReactDOM;

        const ThemeContext = createContext();

        const App = () => {
            const [theme, setTheme] = useState(localStorage.getItem('theme') || (window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light'));
            const [activeTab, setActiveTab] = useState('vault');
            const [passwords, setPasswords] = useState(JSON.parse(localStorage.getItem('passwords')) || []);
            const [searchQuery, setSearchQuery] = useState('');
            const [showSidebar, setShowSidebar] = useState(true);

            useEffect(() => {
                document.body.classList.toggle('dark', theme === 'dark');
                localStorage.setItem('theme', theme);
            }, [theme]);

            const toggleTheme = () => {
                setTheme(theme === 'dark' ? 'light' : 'dark');
            };

            const filteredPasswords = passwords.filter(pwd =>
                pwd.name.toLowerCase().includes(searchQuery.toLowerCase()) ||
                pwd.category.toLowerCase().includes(searchQuery.toLowerCase())
            );

            return (
                <ThemeContext.Provider value={{ theme, toggleTheme }}>
                    <div className="flex h-screen">
                        {/* Sidebar */}
                        <div className={`fixed inset-y-0 left-0 w-64 bg-gray-800 dark:bg-gray-900 text-white p-4 sidebar ${showSidebar ? '' : 'sidebar-hidden'} glass`}>
                            <h2 className="text-2xl font-bold mb-6">Password Vault</h2>
                            <input
                                type="text"
                                placeholder="Search passwords..."
                                className="w-full p-2 mb-4 bg-gray-700 text-white rounded-lg focus:outline-none focus:ring-2 focus:ring-cyan-500"
                                value={searchQuery}
                                onChange={(e) => setSearchQuery(e.target.value)}
                            />
                            <nav>
                                <button
                                    className={`w-full p-2 mb-2 rounded-lg text-left ${activeTab === 'vault' ? 'bg-cyan-600' : 'hover:bg-gray-700'}`}
                                    onClick={() => setActiveTab('vault')}
                                >
                                    <i className="fa fa-vault mr-2"></i> Vault
                                </button>
                                <button
                                    className={`w-full p-2 mb-2 rounded-lg text-left ${activeTab === 'generator' ? 'bg-cyan-600' : 'hover:bg-gray-700'}`}
                                    onClick={() => setActiveTab('generator')}
                                >
                                    <i className="fa fa-key mr-2"></i> Generator
                                </button>
                                <button
                                    className={`w-full p-2 mb-2 rounded-lg text-left ${activeTab === 'checker' ? 'bg-cyan-600' : 'hover:bg-gray-700'}`}
                                    onClick={() => setActiveTab('checker')}
                                >
                                    <i className="fa fa-shield mr-2"></i> Checker
                                </button>
                                <button
                                    className={`w-full p-2 mb-2 rounded-lg text-left ${activeTab === 'dashboard' ? 'bg-cyan-600' : 'hover:bg-gray-700'}`}
                                    onClick={() => setActiveTab('dashboard')}
                                >
                                    <i className="fa fa-chart-line mr-2"></i> Dashboard
                                </button>
                            </nav>
                            <button
                                className="absolute top-4 right-4 p-2 rounded-full bg-cyan-600 hover:bg-cyan-700"
                                onClick={() => setShowSidebar(!showSidebar)}
                            >
                                <i className={`fa ${showSidebar ? 'fa-chevron-left' : 'fa-chevron-right'}`}></i>
                            </button>
                        </div>

                        {/* Main Content */}
                        <div className={`flex-1 p-8 transition-all duration-300 ${showSidebar ? 'ml-64' : 'ml-0'}`}>
                            {activeTab === 'vault' && <PasswordVault passwords={filteredPasswords} setPasswords={setPasswords} />}
                            {activeTab === 'generator' && <PasswordGenerator />}
                            {activeTab === 'checker' && <PasswordChecker />}
                            {activeTab === 'dashboard' && <Dashboard passwords={passwords} />}
                            <button
                                className="fixed top-4 right-4 p-2 rounded-full bg-indigo-600 dark:bg-cyan-600 text-white hover:bg-indigo-700 dark:hover:bg-cyan-700"
                                onClick={toggleTheme}
                                aria-label="Toggle theme"
                            >
                                <i className={`fa ${theme === 'dark' ? 'fa-sun' : 'fa-moon'}`}></i>
                            </button>
                        </div>
                    </div>
                </ThemeContext.Provider>
            );
        };

        const PasswordVault = ({ passwords, setPasswords }) => {
            const [name, setName] = useState('');
            const [password, setPassword] = useState('');
            const [category, setCategory] = useState('General');
            const [showModal, setShowModal] = useState(false);
            const [showTooltip, setShowTooltip] = useState(false);
            const addButtonRef = useRef(null);

            const addPassword = () => {
                if (!name || !password) return;
                const newPassword = { id: Date.now(), name, password, category, createdAt: new Date().toISOString() };
                setPasswords([...passwords, newPassword]);
                localStorage.setItem('passwords', JSON.stringify([...passwords, newPassword]));
                setName('');
                setPassword('');
                setShowModal(false);
            };

            const exportPasswords = () => {
                const data = JSON.stringify(passwords);
                const blob = new Blob([data], { type: 'application/json' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = 'passwords.json';
                a.click();
                URL.revokeObjectURL(url);
            };

            const importPasswords = (e) => {
                const file = e.target.files[0];
                const reader = new FileReader();
                reader.onload = (event) => {
                    const imported = JSON.parse(event.target.result);
                    setPasswords([...passwords, ...imported]);
                    localStorage.setItem('passwords', JSON.stringify([...passwords, ...imported]));
                };
                reader.readAsText(file);
            };

            return (
                <div className="glass p-8 rounded-3xl">
                    <h2 className="text-3xl font-bold mb-6 text-gray-900 dark:text-white">Password Vault</h2>
                    <button
                        ref={addButtonRef}
                        className="p-3 bg-cyan-600 text-white rounded-xl hover:bg-cyan-700 mb-4"
                        onClick={() => setShowModal(true)}
                        onMouseEnter={() => setShowTooltip(true)}
                        onMouseLeave={() => setShowTooltip(false)}
                    >
                        Add Password
                    </button>
                    {showTooltip && (
                        <div
                            className="tooltip"
                            style={{
                                top: addButtonRef.current.offsetTop + addButtonRef.current.offsetHeight + 5,
                                left: addButtonRef.current.offsetLeft
                            }}
                        >
                            Add a new password to your vault
                        </div>
                    )}
                    <button
                        className="p-3 bg-gray-600 text-white rounded-xl hover:bg-gray-700 ml-2"
                        onClick={exportPasswords}
                    >
                        Export Passwords
                    </button>
                    <label className="p-3 bg-gray-600 text-white rounded-xl hover:bg-gray-700 ml-2 cursor-pointer">
                        Import Passwords
                        <input type="file" accept=".json" onChange={importPasswords} className="hidden" />
                    </label>
                    <div className="grid grid-cols-1 md:grid-cols-2 gap-4 mt-4">
                        {passwords.map(pwd => (
                            <div key={pwd.id} className="p-4 bg-gray-50 dark:bg-gray-700 rounded-lg">
                                <h3 className="font-semibold">{pwd.name}</h3>
                                <p className="text-sm text-gray-600 dark:text-gray-300">{pwd.category}</p>
                                <p className="text-sm text-gray-600 dark:text-gray-300">{pwd.password}</p>
                            </div>
                        ))}
                    </div>
                    {showModal && (
                        <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center">
                            <div className="glass p-6 rounded-2xl modal show">
                                <h3 className="text-lg font-semibold mb-4">Add Password</h3>
                                <input
                                    type="text"
                                    placeholder="Name"
                                    className="w-full p-3 mb-4 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100"
                                    value={name}
                                    onChange={(e) => setName(e.target.value)}
                                />
                                <input
                                    type="password"
                                    placeholder="Password"
                                    className="w-full p-3 mb-4 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100"
                                    value={password}
                                    onChange={(e) => setPassword(e.target.value)}
                                />
                                <select
                                    className="w-full p-3 mb-4 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100"
                                    value={category}
                                    onChange={(e) => setCategory(e.target.value)}
                                >
                                    <option>General</option>
                                    <option>Work</option>
                                    <option>Personal</option>
                                    <option>Finance</option>
                                </select>
                                <div className="flex space-x-2">
                                    <button
                                        className="flex-1 p-3 bg-cyan-600 text-white rounded-xl hover:bg-cyan-700"
                                        onClick={addPassword}
                                    >
                                        Save
                                    </button>
                                    <button
                                        className="p-3 bg-gray-600 text-white rounded-xl hover:bg-gray-700"
                                        onClick={() => setShowModal(false)}
                                    >
                                        Cancel
                                    </button>
                                </div>
                            </div>
                        </div>
                    )}
                </div>
            );
        };

        const PasswordGenerator = () => {
            const [length, setLength] = useState(12);
            const [options, setOptions] = useState({
                uppercase: true,
                lowercase: true,
                numbers: true,
                symbols: true
            });
            const [password, setPassword] = useState('');
            const [showQRModal, setShowQRModal] = useState(false);
            const qrRef = useRef(null);

            const generatePassword = async () => {
                const uppercase = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ';
                const lowercase = 'abcdefghijklmnopqrstuvwxyz';
                const numbers = '0123456789';
                const symbols = '!@#$%^&*()_+-=[]{}|;:,.<>?';
                let chars = '';
                if (options.uppercase) chars += uppercase;
                if (options.lowercase) chars += lowercase;
                if (options.numbers) chars += numbers;
                if (options.symbols) chars += symbols;

                if (!chars) return;

                let newPassword = '';
                for (let i = 0; i < length; i++) {
                    const randomIndex = Math.floor(Math.random() * chars.length);
                    newPassword += chars[randomIndex];
                }
                setPassword(newPassword);
            };

            const generateQR = () => {
                if (!password) return;
                qrRef.current.innerHTML = '';
                new QRCode(qrRef.current, {
                    text: password,
                    width: 128,
                    height: 128,
                    colorDark: '#1f2937',
                    colorLight: '#ffffff',
                    correctLevel: QRCode.CorrectLevel.H
                });
                setShowQRModal(true);
            };

            return (
                <div className="glass p-8 rounded-3xl">
                    <h2 className="text-3xl font-bold mb-6 text-gray-900 dark:text-white">Password Generator</h2>
                    <div className="space-y-4">
                        <div>
                            <label className="block text-sm font-medium text-gray-700 dark:text-gray-200">
                                Length: {length}
                            </label>
                            <input
                                type="range"
                                min="8"
                                max="32"
                                value={length}
                                onChange={(e) => setLength(e.target.value)}
                                className="w-full"
                            />
                        </div>
                        <div className="space-y-2">
                            {Object.keys(options).map(key => (
                                <label key={key} className="flex items-center">
                                    <input
                                        type="checkbox"
                                        checked={options[key]}
                                        onChange={() => setOptions({ ...options, [key]: !options[key] })}
                                        className="h-4 w-4 text-cyan-600"
                                    />
                                    <span className="ml-2 text-sm text-gray-700 dark:text-gray-200">{key.charAt(0).toUpperCase() + key.slice(1)}</span>
                                </label>
                            ))}
                        </div>
                        <div className="flex items-center space-x-2">
                            <input
                                type="text"
                                value={password}
                                readOnly
                                className="w-full p-3 rounded-lg bg-gray-50 dark:bg-gray-700 text-gray-900 dark:text-gray-100"
                            />
                            <button
                                className="p-3 bg-cyan-600 text-white rounded-xl hover:bg-cyan-700"
                                onClick={() => navigator.clipboard.writeText(password)}
                            >
                                <i className="fa fa-copy"></i>
                            </button>
                            <button
                                className="p-3 bg-gray-600 text-white rounded-xl hover:bg-gray-700"
                                onClick={generateQR}
                            >
                                <i className="fa fa-qrcode"></i>
                            </button>
                        </div>
                        <button
                            className="w-full p-3 bg-cyan-600 text-white rounded-xl hover:bg-cyan-700"
                            onClick={generatePassword}
                        >
                            Generate Password
                        </button>
                    </div>
                    {showQRModal && (
                        <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center">
                            <div className="glass p-6 rounded-2xl modal show">
                                <h3 className="text-lg font-semibold mb-4">Password QR Code</h3>
                                <div ref={qrRef} className="flex justify-center mb-4"></div>
                                <button
                                    className="w-full p-3 bg-cyan-600 text-white rounded-xl hover:bg-cyan-700"
                                    onClick={() => setShowQRModal(false)}
                                >
                                    Close
                                </button>
                            </div>
                        </div>
                    )}
                </div>
            );
        };

        const PasswordChecker = () => {
            const [password, setPassword] = useState('');
            const [strength, setStrength] = useState({ score: 0, text: '', entropy: 0 });
            const [breach, setBreach] = useState({ breached: false, count: 0 });

            const checkStrength = async () => {
                if (!password) {
                    setStrength({ score: 0, text: '', entropy: 0 });
                    setBreach({ breached: false, count: 0 });
                    return;
                }

                let score = 0;
                if (password.length > 8) score += 20;
                if (password.length > 12) score += 20;
                if (/[A-Z]/.test(password)) score += 20;
                if (/[a-z]/.test(password)) score += 20;
                if (/[0-9]/.test(password)) score += 10;
                if (/[^A-Za-z0-9]/.test(password)) score += 10;

                const entropy = (Math.log2(new Set(password).size) * password.length).toFixed(2);
                let text = score >= 80 ? 'Strong' : score >= 50 ? 'Medium' : 'Weak';
                setStrength({ score, text, entropy });

                const hash = sha1(password).toUpperCase();
                const prefix = hash.slice(0, 5);
                const suffix = hash.slice(5);

                try {
                    const response = await fetch(`https://api.pwnedpasswords.com/range/${prefix}`);
                    const text = await response.text();
                    const lines = text.split('\n');
                    for (let line of lines) {
                        const [hashSuffix, count] = line.split(':');
                        if (hashSuffix === suffix) {
                            setBreach({ breached: true, count: parseInt(count) });
                            return;
                        }
                    }
                    setBreach({ breached: false, count: 0 });
                } catch (error) {
                    console.error('Error checking breach:', error);
                }
            };

            useEffect(() => {
                const debounce = setTimeout(() => checkStrength(), 500);
                return () => clearTimeout(debounce);
            }, [password]);

            return (
                <div className="glass p-8 rounded-3xl">
                    <h2 className="text-3xl font-bold mb-6 text-gray-900 dark:text-white">Password Checker</h2>
                    <input
                        type="password"
                        placeholder="Enter password"
                        className="w-full p-3 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100"
                        value={password}
                        onChange={(e) => setPassword(e.target.value)}
                    />
                    {strength.score > 0 && (
                        <div className="mt-4">
                            <div className={`strength-bar w-${strength.score}/5 ${strength.text === 'Strong' ? 'bg-cyan-500' : strength.text === 'Medium' ? 'bg-yellow-400' : 'bg-red-500'}`}></div>
                            <p className="text-sm text-gray-600 dark:text-gray-300 mt-2">Strength: {strength.text}</p>
                            <p className="text-sm text-gray-600 dark:text-gray-300">Entropy: {strength.entropy} bits</p>
                            {breach.breached && (
                                <p className="text-sm text-red-600 dark:text-red-400">Found in {breach.count} breaches!</p>
                            )}
                        </div>
                    )}
                </div>
            );
        };

        const Dashboard = ({ passwords }) => {
            const strongPasswords = passwords.filter(pwd => {
                let score = 0;
                if (pwd.password.length > 8) score += 20;
                if (pwd.password.length > 12) score += 20;
                if (/[A-Z]/.test(pwd.password)) score += 20;
                if (/[a-z]/.test(pwd.password)) score += 20;
                if (/[0-9]/.test(pwd.password)) score += 10;
                if (/[^A-Za-z0-9]/.test(pwd.password)) score += 10;
                return score >= 80;
            }).length;

            return (
                <div className="glass p-8 rounded-3xl">
                    <h2 className="text-3xl font-bold mb-6 text-gray-900 dark:text-white">Password Health Dashboard</h2>
                    <div className="grid grid-cols-1 md:grid-cols-3 gap-4">
                        <div className="p-4 bg-gray-50 dark:bg-gray-700 rounded-lg">
                            <h3 className="font-semibold">Total Passwords</h3>
                            <p className="text-2xl">{passwords.length}</p>
                        </div>
                        <div className="p-4 bg-gray-50 dark:bg-gray-700 rounded-lg">
                            <h3 className="font-semibold">Strong Passwords</h3>
                            <p className="text-2xl">{strongPasswords}</p>
                        </div>
                        <div className="p-4 bg-gray-50 dark:bg-gray-700 rounded-lg">
                            <h3 className="font-semibold">Categories</h3>
                            <p className="text-2xl">{new Set(passwords.map(pwd => pwd.category)).size}</p>
                        </div>
                    </div>
                </div>
            );
        };

        const root = createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
